# frozen_string_literal: true

# This class will contain a single files code from the website passed in the file structure class
class SourceCode < ComprehensiveScan
  def initialize(name, data)
    @name = name
    puts "#{@name} has been initialized"
    @data = data
    check_for_comments
    check_for_php_includes
    puts "\n\n"
  end

  def check_for_comments
    html_comments = @data.scan(/<!--.*?-->/m)

    if html_comments.empty?
      puts "No comments found in #{@name}"
    else
      puts "Comments found in #{@name}:".colorize(:yellow)
      html_comments.each { |comment| puts comment unless ['<!---->', '<!-- -->'].include?(comment) }
    end
  end

  def check_for_php_includes # rubocop:disable Metrics/MethodLength
    if @data.include?('<?php')
      puts "PHP code found in #{@name}".colorize(:yellow)
      includes = @data.scan(/include\s*'"['"]/)
      if includes.empty?
        puts "No include statements found in #{@name}"
      else
        puts "Include statements found in #{@name}:".colorize(background: :red)
        includes.each { |include| puts include }
      end
    else
      puts "No PHP code found in #{@name}"
    end
  end
end
