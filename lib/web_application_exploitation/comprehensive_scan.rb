# frozen_string_literal: true

require 'tty-prompt'
require_relative 'web_application_exploitation'
require_relative 'web_application_exploitation_ascii_art'

# This class displays the menu and houses the funtions for the comprehensive scan
# The website scan scans a website with every method at a single time
# useful if you need to see everything and know whats important
class ComprehensiveScan < WebApplicationExploitation
  def initialize
    require_relative 'file_structure'
    require_relative 'robots_scan'
    WebApplicationExploitationAsciiArt.new('comprehensive')
    @url = obtain_url
    @robots = RobotsScan.new(@url)
    @file_structure = FileStructure.new(@url)
    main
  end

  def main
    prompt = TTY::Prompt.new

    options = [
      { name: 'Print File Tree', value: -> { @file_structure.print_tree } },
      { name: 'Go to previous menu', value: -> { WebApplicationExploitation.new } },
      { name: 'Go to Main Menu', value: -> { Toolbox.new } },
      { name: 'Quit Program', value: -> { clear_terminal && exit } }

    ]
    prompt.multi_select('Please select your options for the audit', options)
    quit_or_continue(ComprehensiveScan)
  end
end
