# frozen_string_literal: true

require 'tty-prompt'
require_relative 'web_application_exploitation'
require_relative 'web_application_exploitation_ascii_art'

# This class displays the menu and houses the funtions for the comprehensive scan
# The website scan scans a website with every method at a single time
# useful if you need to see everything and know whats important
class ComprehensiveScan < WebApplicationExploitation
  def initialize
    require_relative 'file_structure'
    require_relative 'robots_scan'
    require_relative 'request'
    WebApplicationExploitationAsciiArt.new('comprehensive')
    @url = obtain_url
    @robots = RobotsScan.new(@url)
    @file_structure = FileStructure.new(@url)
    @requests_inspection = Request.new(@url)
    main
  end

  def main # rubocop:disable Metrics/MethodLength
    prompt = TTY::Prompt.new
    options = [
      { name: 'Show robots.txt', value: -> { @robots.print_disallow_lines } },
      { name: 'Show File Tree', value: -> { @file_structure.print_tree } },
      { name: 'Show request', value: -> { @requests_inspection.show_requests } },
      { name: 'Go to previous menu', value: -> { WebApplicationExploitation.new } },
      { name: 'Go to Main Menu', value: -> { Toolbox.new } },
      { name: 'Quit Program', value: -> { clear_terminal && exit } }
    ]
    prompt.multi_select('Please select your options for the audit', options, cycle: true, per_page: 6)
    quit_or_continue(ComprehensiveScan)
  end
end
